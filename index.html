<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    <link rel="manifest" href="manifest.json">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dice Roller - Fixed</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.5s ease;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        .container {
            text-align: center;
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .instruction {
            position: absolute;
            top: 20%;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.5rem;
            font-weight: 600;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            animation: float 3s ease-in-out infinite;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            backdrop-filter: blur(5px);
        }

        .dice-container {
            position: relative;
            width: 200px;
            height: 200px;
            perspective: 1000px;
        }

        .dice {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .dice-face {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 5rem;
            font-weight: 800;
            color: #333;
            box-shadow: 
                inset 0 0 15px rgba(0, 0, 0, 0.1),
                0 10px 30px rgba(0, 0, 0, 0.2);
            backface-visibility: hidden;
            border: 2px solid rgba(255, 255, 255, 0.8);
        }

        .dice-face::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            border-radius: 10px;
            background: linear-gradient(145deg, #f0f0f0, #ffffff);
            z-index: -1;
        }

        .dice-face-1 { transform: rotateY(0deg) translateZ(100px); }
        .dice-face-2 { transform: rotateY(180deg) translateZ(100px); }
        .dice-face-3 { transform: rotateY(90deg) translateZ(100px); }
        .dice-face-4 { transform: rotateY(-90deg) translateZ(100px); }
        .dice-face-5 { transform: rotateX(90deg) translateZ(100px); }
        .dice-face-6 { transform: rotateX(-90deg) translateZ(100px); }

        .rolling .dice {
            animation: roll 1s ease-in-out;
        }

        .history {
            position: absolute;
            bottom: 20px;
            display: flex;
            gap: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            backdrop-filter: blur(5px);
        }

        .history-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .history-dot:hover {
            transform: scale(1.5);
        }

        @keyframes roll {
            0% { transform: rotateX(0) rotateY(0) rotateZ(0); }
            25% { transform: rotateX(90deg) rotateY(180deg) rotateZ(45deg); }
            50% { transform: rotateX(180deg) rotateY(360deg) rotateZ(90deg); }
            75% { transform: rotateX(270deg) rotateY(540deg) rotateZ(135deg); }
            100% { transform: rotateX(360deg) rotateY(720deg) rotateZ(180deg); }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        /* Color themes for each dice result */
        .color-1 { background: linear-gradient(135deg, #ff6b6b, #ff8e8e); }
        .color-2 { background: linear-gradient(135deg, #4e54c8, #8f94fb); }
        .color-3 { background: linear-gradient(135deg, #2ecc71, #1abc9c); }
        .color-4 { background: linear-gradient(135deg, #f9ca24, #f6e58d); }
        .color-5 { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .color-6 { background: linear-gradient(135deg, #e67e22, #e74c3c); }
    </style>
</head>
<body>
    <div class="container">
        <div class="instruction">Tap anywhere to roll</div>
        <div class="dice-container">
            <div class="dice">
                <div class="dice-face dice-face-1">1</div>
                <div class="dice-face dice-face-2">2</div>
                <div class="dice-face dice-face-3">3</div>
                <div class="dice-face dice-face-4">4</div>
                <div class="dice-face dice-face-5">5</div>
                <div class="dice-face dice-face-6">6</div>
            </div>
        </div>
        <div class="history" id="history"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const body = document.body;
            const dice = document.querySelector('.dice');
            const container = document.querySelector('.container');
            const historyContainer = document.getElementById('history');
            const instruction = document.querySelector('.instruction');
            
            // Color mapping for dice results
            const colorMap = {
                1: 'color-1',
                2: 'color-2',
                3: 'color-3',
                4: 'color-4',
                5: 'color-5',
                6: 'color-6'
            };
            
            // Dice rotation mapping for each number
            const rotations = {
                1: 'rotateX(0deg) rotateY(0deg)',
                2: 'rotateX(0deg) rotateY(180deg)',
                3: 'rotateX(0deg) rotateY(90deg)',
                4: 'rotateX(0deg) rotateY(-90deg)',
                5: 'rotateX(90deg) rotateY(0deg)',
                6: 'rotateX(-90deg) rotateY(0deg)'
            };
            
            // Store roll history
            let rollHistory = [];
            
            // Prevent multiple rolls at once
            let isRolling = false;
            
            // Function to roll the dice
            function rollDice() {
                if (isRolling) return;
                isRolling = true;
                
                // Add rolling class for animation
                container.classList.add('rolling');
                
                // Hide instruction after first roll
                instruction.style.display = 'none';
                
                // Generate random number between 1 and 6
                const randomNumber = Math.floor(Math.random() * 6) + 1;
                
                // Add to history
                rollHistory.unshift(randomNumber);
                if (rollHistory.length > 10) {
                    rollHistory.pop();
                }
                updateHistory();
                
                // After animation completes, show result
                setTimeout(() => {
                    // Remove rolling class
                    container.classList.remove('rolling');
                    
                    // Change background color
                    body.className = ''; // Remove previous color classes
                    body.classList.add(colorMap[randomNumber]);
                    
                    // Set dice final position
                    dice.style.transform = rotations[randomNumber];
                    
                    // Trigger haptic feedback on mobile devices
                    if (navigator.vibrate) {
                        navigator.vibrate(50);
                    }
                    
                    isRolling = false;
                }, 1000);
            }
            
            // Update history display
            function updateHistory() {
                historyContainer.innerHTML = '';
                rollHistory.forEach((number, index) => {
                    const dot = document.createElement('div');
                    dot.className = 'history-dot';
                    dot.style.backgroundColor = getColorForNumber(number);
                    dot.title = `Roll ${rollHistory.length - index}: ${number}`;
                    historyContainer.appendChild(dot);
                });
            }
            
            // Helper function to get color for history dots
            function getColorForNumber(number) {
                const colorMap = {
                    1: '#ff6b6b',
                    2: '#4e54c8',
                    3: '#2ecc71',
                    4: '#f9ca24',
                    5: '#9b59b6',
                    6: '#e67e22'
                };
                return colorMap[number] || '#fff';
            }
            
            // Add event listener for tap/click
            document.addEventListener('click', rollDice);
            document.addEventListener('touchstart', rollDice);
            
            // Initialize with a random color
            const initialColor = Math.floor(Math.random() * 6) + 1;
            body.classList.add(colorMap[initialColor]);
        });
    </script>
</body>
</html>